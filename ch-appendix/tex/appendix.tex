\chapter{Appendix}

\section{Details of regularly perturbed example \label{app:regpert}}

The system under investigation is $y' = \epsilon y^3 - y$ with
parameter $\epsilon$ and state $y$. This differential equation is
separable, and, restricting ourselves to $y \ge 0$, we can write down
the analytical solution in terms of $\epsilon$ and $y_0$ as

\begin{align}
  y(t) = \frac{1}{\sqrt{\epsilon + e^{2 t} \left(\frac{1}{y_0^2} -
  \epsilon \right)}}
\label{eq:regpert}
\end{align}

In our analysis, we are interested in the behavior of the system as
$\epsilon \rightarrow 0$. This limiting solution can be found by
simply dropping the $y^3$ term from the differential equation, giving
us

\begin{align}
  \lim_{\epsilon \rightarrow 0} y(t) = y_0 e^{-t}
\label{eq:regpert-limit}
\end{align}

The key distinction between this system and the singularly perturbed
model above is that the initial conditions influence the trajectories
even at small values of $\epsilon$. If we vary both $\epsilon$ and
$y_0$, at large values of $\epsilon$ we will have a model response
governed by equation~\ref{eq:regpert}, a function of both $\epsilon$
and $y_0$. At small values of $\epsilon$, the trajectories converge
to equation~\ref{eq:regpert-limit}, where $\epsilon$ does not
affect the model response.

Looking back at the model manifold depicted in
Fig.~\ref{fig:regpert} (a), this is precisely what we see. At larger
values of $\epsilon$, the model manifold is two dimensional as
variations in both $y_0$ and $\epsilon$ influence the model
response. At smaller values of $\epsilon$, the model manifold
converges to a one-dimensional line parameterized by $y_0$. The exact
form of this line is simply $f(y_0)= \left( y_0 e^{-t_1}, y_0 e^{-t_2}, y_0
  e^{-t_3} \right)$. The dependence on $\epsilon$ is lost.

To create Fig.~\ref{fig:regpert} (a), we fixed $t_1 = 0.25$,
$t_2 = 1.0$ and $t_3 = 1.75$. We then calculated the model response
over the rectangle $y_0 \in [1.25, 3.5]$ and $\log(\epsilon) \in [-3,
-1]$, so for each particular $y_0$ and $\epsilon$ value we have

\begin{align}
  f(y_0, \epsilon) = \begin{bmatrix} y(t_1) \\ y(t_2) \\
    y(t_3) \end{bmatrix} = \begin{bmatrix} \frac{1}{\sqrt{\epsilon + e^{2 t_1} \left(\frac{1}{y_0^2} -
  \epsilon \right)}} \\ 
\frac{1}{\sqrt{\epsilon + e^{2 t_2} \left(\frac{1}{y_0^2} -
      \epsilon \right)}} \\
\frac{1}{\sqrt{\epsilon + e^{2 t_3} \left(\frac{1}{y_0^2} -
      \epsilon \right)}}
\end{bmatrix} \in \mathbb{R}^3
\end{align}

We mask out points for which $y(t_3) > 2.0$ to aid the interpretability of
the figure; otherwise, the few solutions that grow very rapidly stretch
the axes and obscure the bulk of the manifold. 

To create Fig.~\ref{fig:regpert} (b), we performed DMAPS on a set
of nearly 12,000 points. We drew these points uniformly at random over
the rectangle $y_0 \in [1.25, 3.5]$ and $\log(\epsilon) \in [-3, -1]$
as before, and calculated the corresponding model responses, again
omitting points for which $y(t_3) > 2.0$. Applying DMAPS to the
collection of model responses that remained using a $\delta = 1.0$,
and coloring parameter space by the resulting $\phi_1$ values gives
Fig.~\ref{fig:regpert} (b).

A final note of clarification is needed regarding
Fig.~\ref{fig:regpert} (b), namely the existence of the uncolored
white patch in the upper right. Examining equation~\ref{eq:regpert},
we see that our solution may diverge in finite time if
$\left(\frac{1}{y_0^2} - \epsilon \right) < 0$. We can find the exact
time at which the solution becomes infinite by setting the denominator
equal to zero, giving us
$t^* = \ln \left( \sqrt{\frac{y_0^2 \epsilon}{y_0^2 \epsilon - 1}}
\right)$. Thus, having fixed $t_1$, $t_2$ and $t_3$, there are certain
parameter combinations that diverge at $t^* \le t_3$. The model
response is undefined at such points, and therefore we omit these
parameter combinations from our plots.


% \section{Details of singularly perturbed example \label{app:singpert}}

\section{Details of reaction network \label{app:abc}}

%
In this section, we identify the singularly perturbed regime for the dynamics associated with the reaction scheme
%
\[
  A \xrightleftharpoons[k_{-1}]{k_1} B \xrightarrow[]{k_2} C .
\]
%
As we will see, the dynamics in that regime are driven by the single effective parameter $\keff$.

\subsection{Exact solution}
%
The evolution of the molar concentrations is dictated by the linear ODEs
%
\[
 \frac{d}{dt}
\left[\begin{array}{c}
 A \\ B \\ C
\end{array}\right]
=
\left[\begin{array}{ccc}
 -k_1 & k_{-1} & 0 \\ k_1 & -(k_{-1}+k_2) & 0 \\ 0 & k_2 & 0
\end{array}\right]
%
\left[\begin{array}{c}
 A \\ B \\ C
\end{array}\right] ,
%
\ \mbox{subject to} \
%
\left[\begin{array}{c}
 A(0) \\ B(0) \\ C(0)
\end{array}\right]
=
\left[\begin{array}{c}
 A_0 \\ B_0 \\ C_0
\end{array}\right] .
\]
%
This system has the explicit solution
%
\be
\begin{array}{rcl}
\left[\begin{array}{c}
 A(t) \\ B(t) \\ C(t)
\end{array}\right]
&=&
\displaystyle
 \frac{\lp A_0 + (\lp+k_2)B_0}{\dl}
\left[\begin{array}{ccc}
 -(1+\lm/k_2) \\ \lm/k_2 \\ 1
\end{array}\right]
 \mathrm{e}^{\lm t}
\\
&{}&
\displaystyle
+
 \frac{\lm A_0 + (\lm+k_2)B_0}{\dl}
\left[\begin{array}{ccc}
 -(1+\lp/k_2) \\ \lp/k_2 \\ 1
\end{array}\right]
 \mathrm{e}^{\lp t}
\\
&{}&
\displaystyle
+
 (A_0+B_0+C_0)
\left[\begin{array}{ccc}
 0 \\ 0 \\ 1
\end{array}\right] ,
\end{array}
\label{ABC-soln}
\ee
%
where $\dl = \lp-\lm > 0$ is the difference between the nonzero eigenvalues
%
\be
 \lpm
=
 \frac{1}{2}
\left[
 -(k_{-1}+k_1+k_2)
\pm
 \sqrt{(k_{-1}+k_1+k_2)^2 - 4 k_1 k_2}
\right]
<
 0 .
\label{ABC-lambda}
\ee
%
Among them, $\lm$ controls the fastest timescale (\emph{transient dynamics})
and $\lp$ the rate of approach to the steady state $(A_*,B_*,C_*)=(0,0,A_0+B_0+C_0)$ (\emph{slow dynamics}).
The third eigenvalue is identically zero and associated with the conservation law $A(t)+B(t)+C(t)=A_0+B_0+C_0$.
For our purposes, we assume a fixed initial state $(A_0,B_0,C_0)=(1,0,0)$
(in arbitrary units) and variable reaction rates $\p = (k_{-1},k_1,k_2)$.
Observing the system takes the form of monitoring the product concentration at preset times $0 \le t_1 < \ldots < t_N$,
whence $\omr(\p) = (C(t_1 \vert \p) , \ldots , C(t_N \vert \p))^\mathrm{T}$.

\subsection{Singularly perturbed regime}
%
Rearrranging terms from slowest to fastest in \eqref{ABC-soln} yields
%
\be
 C(t \vert \p)
=
 1
+
 \frac{\lm}{\dl}
 \mathrm{e}^{\lp t}
\left(
 1
+
 \frac{\lp}{\lm}
 \mathrm{e}^{r \lp t}
\right) ,
\quad\mbox{with}\
 r = \frac{\dl}{|\lp|} > 0 .
\label{ABC-C-soln}
\ee
%
To resolve the slow dynamics, we select $t_1 = \alpha/|\lp|$ for $\alpha \approx 0.5$.
In the presence of timescale disparity, the fast component should be negligible by that time already,
which necessitates that $\vert\lp/\lm\vert \mathrm{e}^{-\alpha r} \ll 1$.
This order relation determines the asymptotic regime in parameter space.
Since the ratio $\vert\lp/\lm\vert$ depends only algebraically on $\p$,
timescale separation must arise from the exponential term
for all $r> r_*$ with $\alpha r_* \gg 1$.
As an indication, the value $r_* = 6$ reduces the exponential term to approximately $0.05$.\\

To identify the asymptotic regime explicitly, we work with the compactification
%
\be
 \eps
=
%  \frac{1}{4}
% \left[
%  1 - \left(\frac{\dl}{\Sigma |\lambda|}\right)^2
% \right]
% =
 \frac{1}{4}
\left[
 1 - \left(\frac{r}{r+2}\right)^2
\right]
=
 \frac{k_1 k_2}{(k_{-1}+k_1+k_2)^2}
<
 \eps_*
=
 \frac{1}{4}
\left[
 1 - \left(\frac{r_*}{r_*+2}\right)^2
\right] ,
\label{ABC-asympt-bound}
\ee
%
where we have used \eqref{ABC-lambda} to express $r$ in terms of the kinetic parameters.
The composite parameter $\eps$ decreases with $r$ from $1/4$ to zero,
hence timescale disparity exists for $\eps < \eps_* \ll 1$: $\eps$ acts as a \emph{small parameter}.
As an indication, the value $r_*=6$ above yields $\eps_* \approx 0.11$.
To understand the quadratic curve~\eqref{ABC-asympt-bound} bounding the singularly perturbed regime,
we introduce the transformation
%
\[
\left[\begin{array}{c}
 \kappa_1 \\ \kappa_2
\end{array}\right]
=
 \frac{1}{\sqrt2}
%
\left[\begin{array}{rr}
 1+\sqrt{1-4\eps_*} & -1+\sqrt{1-4\eps_*} \\ -1+\sqrt{1-4\eps_*} & 1+\sqrt{1-4\eps_*}
\end{array}\right]
%
\left[\begin{array}{c}
 k_1/k_{-1} - 2 \eps_*/(1 - 4 \eps_*) \\ k_2/k_{-1} - 2 \eps_*/(1 - 4 \eps_*)
\end{array}\right]
\]
%
that factorizes \eqref{ABC-asympt-bound} as $\kappa_1 \kappa_2 < 2 \eps_*/(1 - 4 \eps_*)$.
In the $(\kappa_1,\kappa_2)-$plane, the asymptotic regime is bounded by two hyperbolas in the first and third quadrants.
Since the $\kappa_1-$ and $\kappa_2-$axes align with the axes in the $(k_1/k_{-1},k_2/k_{-1})$ plane, at leading order,
the regime $\eps_* \downarrow 0$ becomes a narrow sliver.\\
%
\subsection{Effective parameter}
%
By construction, data generated by parameter values in the asymptotic
regime are well-described by the slow component alone, whose decay
rate is
%
\[
 \vert \lp \vert
=
 \frac{1 - \sqrt{1-4\eps}}{2}
 (k_{-1}+k_1+k_2)
\sim
 \frac{k_1 k_2}{k_{-1}+k_1+k_2}
=
 \keff .
\]
%
For parameter values in that regime, the observable effectively reads (cf.~\eqref{ABC-C-soln})
%
\[
 C(t \vert \p)
=
 1
-
 \mathrm{e}^{-\keff t} ,
\quad\mbox{since}\
 \frac{\lp}{\lm}
 \mathrm{e}^{-r \lp t}
\ll
 1
\ \mbox{and} \
 \frac{\lm}{\dl}
=
-
\frac{
 1 + \sqrt{1 - 4 \eps}
}{
 2 \sqrt{1 - 4 \eps}
}
\sim
 -1 .
\]
%

This leading order result shows the observable to depend solely on the
decay rate $\keff$, in the singularly perturbed regime.  That regime
is foliated by (subsets of) the level sets of $\keff$,
with the model response remaining largely constant on each such surface.

It is interesting to note that, next to sloppiness, the setup above
also exhibits structural non-identifiability.  Indeed, the
observable only depends on the two parameter combinations $\lpm$, see
the exact formula \eqref{ABC-C-soln}.  It is important to understand
that this effect is distinct from timescale disparity and thus not
limited to the singularly perturbed regime.  This further entails that
the parameter space is foliated by curves along which $\lpm$ remain
constant, with all points on any such curve yielding identical
model responses.  Since $\keff$ is merely another name for $\lp$, each
surface $\keff = const.$ is itself foliated by these curves.  In other
words, the curves of identical model response (constant $\lpm$)
foliate surfaces of leading-order identical model response
(constant $\lp$) which, in turn, foliate the singularly perturbed
regime.  We remark once again that sloppiness and non-identifialibity
are pertinent to both the system and the monitoring protocol employed.
Allowing $B_0>0$ in the initial condition or observing $A(t)$ and/or
$B(t)$, next to $C(t)$, suffices to lift the non-identifiability.\\